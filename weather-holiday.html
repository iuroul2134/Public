<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>天气 + 节日倒计时</title>

<style>
body {
  margin: 0;
  background: transparent;
  font-family: "微软雅黑", "PingFang SC", sans-serif;
}

.card {
  width: 360px;
  height: 360px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  text-align: center;
}

/* 黑字 + 白描边 */
.stroke {
  color: #000;
  text-shadow:
    -1px -1px 0 #fff,
     1px -1px 0 #fff,
    -1px  1px 0 #fff,
     1px  1px 0 #fff;
}

.city {
  font-size: 18px;
  margin-bottom: 6px;
}

.temp {
  font-size: 48px;
  font-weight: 600;
}

.divider {
  width: 80%;
  height: 1px;
  background: rgba(0,0,0,0.3);
  margin: 12px 0;
}

.holiday {
  font-size: 16px;
}

.days {
  font-size: 32px;
  font-weight: 600;
}
</style>
</head>

<body>
<div class="card">
  <div id="city" class="city stroke">加载中…</div>
  <div id="temp" class="temp stroke">--℃</div>

  <div class="divider"></div>

  <div id="holidayName" class="holiday stroke">距离 节日</div>
  <div id="holidayDays" class="days stroke">-- 天</div>
</div>

<script>
// ================= 天气（省会轮播） =================
const cities = [
  { name: "北京", lat: 39.9042, lon: 116.4074 },
  { name: "上海", lat: 31.2304, lon: 121.4737 },
  { name: "广州", lat: 23.1291, lon: 113.2644 },
  { name: "深圳", lat: 22.5431, lon: 114.0579 },
  { name: "成都", lat: 30.5728, lon: 104.0668 },
  { name: "杭州", lat: 30.2741, lon: 120.1551 },
  { name: "武汉", lat: 30.5928, lon: 114.3055 },
  { name: "西安", lat: 34.3416, lon: 108.9398 }
];

let cityIndex = 0;

function loadWeather() {
  const city = cities[cityIndex];
  document.getElementById("city").innerText = city.name;

  fetch(`https://api.open-meteo.com/v1/forecast?latitude=${city.lat}&longitude=${city.lon}&current_weather=true`)
    .then(res => res.json())
    .then(data => {
      document.getElementById("temp").innerText =
        Math.round(data.current_weather.temperature) + "℃";
    })
    .catch(() => {
      document.getElementById("temp").innerText = "--℃";
    });

  cityIndex = (cityIndex + 1) % cities.length;
}

loadWeather();
setInterval(loadWeather, 10000);

// ================= 节日倒计时（自动切换） =================
const holidays = [
  { name: "春节", date: new Date("2026-02-17") },
  { name: "情人节", date: new Date("2026-02-14") },
  { name: "元宵节", date: new Date("2026-03-03") }
];

function updateHoliday() {
  const now = new Date();

  // 找到最近的未到节日
  const upcoming = holidays
    .map(h => ({
      ...h,
      diff: h.date - now
    }))
    .filter(h => h.diff > 0)
    .sort((a, b) => a.diff - b.diff)[0];

  if (!upcoming) {
    document.getElementById("holidayName").innerText = "节日已过";
    document.getElementById("holidayDays").innerText = "-- 天";
    return;
  }

  const days = Math.ceil(upcoming.diff / (1000 * 60 * 60 * 24));
  document.getElementById("holidayName").innerText = "距离 " + upcoming.name;
  document.getElementById("holidayDays").innerText = days + " 天";
}

updateHoliday();
setInterval(updateHoliday, 60 * 1000);
</script>
</body>
</html>
